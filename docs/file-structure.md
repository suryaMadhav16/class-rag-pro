# Project File Structure

This document provides an overview of the project's file structure and the purpose of each file and directory.

## Root Directory

```
/
├── .devcontainer/           # Development container configuration
├── .git/                    # Git repository
├── .vscode/                 # VS Code configuration
├── app/                     # Main application code
├── config/                  # Configuration files
├── data/                    # Source data for embedding
├── docs/                    # Documentation
├── my_chroma_data/          # Local ChromaDB data
├── output/                  # Output files generated by tools
├── storage/                 # Persistent storage for embeddings and documents
├── tests/                   # Test files
├── .env                     # Environment variables
├── .gitignore               # Git ignore file
├── DEPLOY.md                # Deployment instructions
├── Dockerfile               # Docker configuration
├── README.md                # Project README
├── chroma.log               # ChromaDB log file
├── main.py                  # Main entry point
├── poetry.lock              # Poetry lock file
├── pyproject.toml           # Project dependencies and configuration
└── run.py                   # Development and production runner
```

## App Directory Structure

The `app` directory contains the main application code and is organized as follows:

```
app/
├── __init__.py              # Package initialization
├── api/                     # API layer
│   ├── __init__.py
│   ├── routers/             # API route handlers
│   └── services/            # API-specific services
├── config.py                # Application configuration
├── engine/                  # Core RAG engine
│   ├── __init__.py
│   ├── generate.py          # Data ingestion pipeline
│   ├── index.py             # Index management
│   ├── loaders/             # Document loaders
│   ├── query_filter.py      # Query filtering
│   ├── tools/               # Tool implementations
│   └── vectordb.py          # Vector database integration
├── llmhub.py                # T-Systems LLMHub integration
├── middlewares/             # FastAPI middleware
├── observability.py         # Observability hooks
├── services/                # Application services
└── settings.py              # LLM and embedding settings
```

## API Routers

The `app/api/routers` directory contains the API endpoint implementations:

```
app/api/routers/
├── __init__.py              # Router initialization and configuration
├── chat.py                  # Chat endpoints
├── chat_config.py           # Chat configuration endpoints
├── events.py                # Event handling for streaming
├── models.py                # API data models
├── query.py                 # Knowledge base query endpoint
├── upload.py                # File upload endpoint
└── vercel_response.py       # Streaming response handling
```

## Engine Components

The `app/engine` directory contains the core RAG implementation:

```
app/engine/
├── __init__.py              # Package initialization
├── engine.py                # Chat engine configuration
├── generate.py              # Document ingestion pipeline
├── index.py                 # Vector index management
├── loaders/                 # Document loaders
│   ├── __init__.py          # Loader orchestration
│   ├── db.py                # Database loader
│   ├── file.py              # File loader
│   └── web.py               # Web page loader
├── query_filter.py          # Query filtering
├── tools/                   # Tool implementations
│   ├── __init__.py          # Tool factory
│   ├── artifact.py          # Artifact tool
│   ├── document_generator.py # Document generation tool
│   ├── duckduckgo.py        # DuckDuckGo search tool
│   ├── form_filling.py      # Form filling tool
│   ├── img_gen.py           # Image generation tool
│   ├── interpreter.py       # Code interpreter tool
│   ├── openapi_action.py    # OpenAPI action tool
│   ├── query_engine.py      # Query engine tool
│   └── weather.py           # Weather tool
└── vectordb.py              # ChromaDB integration
```

## Configuration Files

The `config` directory contains configuration files for the application:

```
config/
├── loaders.yaml             # Document loader configuration
└── tools.yaml               # Tool configuration
```

## Data Directory

The `data` directory contains source documents for embedding:

```
data/
├── [various document files]  # Source documents (PDF, DOCX, TXT, etc.)
```

## Storage Directory

The `storage` directory contains persistent storage for embeddings and documents:

```
storage/
├── docstore.json            # Document store data
└── nodes/                   # Node data
```

## Output Directory

The `output` directory contains files generated by tools:

```
output/
├── tools/                   # Files generated by tools
└── uploaded/                # Uploaded files
```

## My ChromaDB Data Directory

The `my_chroma_data` directory contains local ChromaDB data:

```
my_chroma_data/
├── chroma.sqlite3           # ChromaDB SQLite database
└── [other ChromaDB files]   # ChromaDB index files
```

## File Descriptions

### Root Files

| File | Description |
|------|-------------|
| `.env` | Environment variables for the application |
| `DEPLOY.md` | Instructions for deploying the application |
| `Dockerfile` | Docker configuration for containerization |
| `README.md` | Project overview and instructions |
| `main.py` | Main entry point for the application |
| `poetry.lock` | Poetry dependency lock file |
| `pyproject.toml` | Project dependencies and configuration |
| `run.py` | Development and production runner |

### Core Application Files

| File | Description |
|------|-------------|
| `app/config.py` | Defines constants for data directory and static directory paths |
| `app/settings.py` | Manages model settings and integrations with different AI model providers |
| `app/llmhub.py` | Specialized integration for T-Systems LLMHub |
| `app/observability.py` | Placeholder for observability implementation |

### API Layer Files

| File | Description |
|------|-------------|
| `app/api/routers/__init__.py` | Configures API router with various endpoint groups |
| `app/api/routers/chat.py` | Implements chat endpoints |
| `app/api/routers/chat_config.py` | Provides configuration for chat functionality |
| `app/api/routers/events.py` | Implements an event handling system for streaming responses |
| `app/api/routers/models.py` | Defines data models for the API |
| `app/api/routers/query.py` | Implements a simple query endpoint for direct knowledge base access |
| `app/api/routers/upload.py` | Handles file uploads and processing for chat attachments |
| `app/api/routers/vercel_response.py` | Implements streaming response handling compatible with Vercel |

### Engine Layer Files

| File | Description |
|------|-------------|
| `app/engine/engine.py` | Creates and configures the chat engine with appropriate tools and settings |
| `app/engine/generate.py` | Implements data source generation functionality |
| `app/engine/index.py` | Manages vector index creation and loading |
| `app/engine/query_filter.py` | Implements filtering logic for document queries |
| `app/engine/vectordb.py` | Configures and initializes the ChromaDB vector store |

### Loaders

| File | Description |
|------|-------------|
| `app/engine/loaders/__init__.py` | Orchestrates document loading from various sources |
| `app/engine/loaders/file.py` | Implements file loading from local directory |
| `app/engine/loaders/web.py` | Implements web page scraping and loading functionality |
| `app/engine/loaders/db.py` | Implements database content loading functionality |

### Tools

| File | Description |
|------|-------------|
| `app/engine/tools/__init__.py` | Implements a tool factory pattern for loading and managing various tools |
| `app/engine/tools/query_engine.py` | Implements query engine tool for retrieving information from the knowledge base |
| `app/engine/tools/document_generator.py` | Implements document generation (PDF, HTML) from markdown content |
| `app/engine/tools/duckduckgo.py` | Implements search functionality using DuckDuckGo |
